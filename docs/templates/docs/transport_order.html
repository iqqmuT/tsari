{% extends "base.html" %}

{% block main %}

{% load i18n %}
{% load docs_extras %}

<div class="container">
  <div class="text-center">
    <h1>TRANSPORT ORDER</h1>
    <h4>{{ to.name }}
      ({{ to.get_from_loc.abbreviation }} &mdash; {{ to.get_to_loc.abbreviation }})
    </h4>
  </div> <!-- .row -->

  <div class="row">
    <div class="col-1">From:</div>
    <div class="col-11">
      {% if to.from_convention %}{{ to.from_convention.name }}{% elif to.from_loc %}{{ to.from_loc.name }}{% endif %}
    </div>
  </div>

  <div class="row">
    <div class="col-1">To:</div>
    <div class="col-11">
      {% if to.to_convention %}{{ to.to_convention.name }}{% elif to.to_loc %}{{ to.to_loc.name }}{% endif %}
    </div>
  </div>

  <h4 class="to-header">SHIPPING</h4>

  <div class="row">
    <div class="col-6">
      <div class="p-1 mb-2 bg-secondary text-white">
        <strong>LOADING</strong>
      </div>

      {% if to.from_convention.load_out %}
        {{ to.from_convention.load_out|date:"j.n.Y H:i" }}
      {% else %}
        {{ to.from_loc_load_out|date:"j.n.Y H:i" }}
      {% endif %}
      <br>

      {{ to.get_from_loc.address }}

      {% if to.get_from_loc.entrance %}
        <br>
        {{ to.get_from_loc.entrance }}
      {% endif %}
    </div>

    <div class="col-6">
      <div class="p-1 mb-2 bg-secondary text-white">
        <strong>UNLOADING</strong>
      </div>

      {% if to.to_convention.load_in %}
        {{ to.to_convention.load_in|date:"j.n.Y H:i" }}
      {% else %}
        {{ to.to_loc_load_in|date:"j.n.Y H:i" }}
      {% endif %}
      <br>

      {{ to.get_to_loc.address }}

      {% if to.get_to_loc.entrance %}
        <br>
        {{ to.get_to_loc.entrance }}
      {% endif %}

    </div>
  </div>

  <h4 class="to-header">CONTACT</h4>

  <div class="row">
    <div class="col-6">
      {% if to.from_convention.contact_person %}
        {{ to.from_convention.contact_person.name }}<br>
        {{ to.from_convention.contact_person.phone }}<br>
        {{ to.from_convention.contact_person.email }}
      {% endif %}
    </div>

    <div class="col-6">
      {% if to.to_convention.contact_person %}
        {{ to.to_convention.contact_person.name }}<br>
        {{ to.to_convention.contact_person.phone }}<br>
        {{ to.to_convention.contact_person.email }}
      {% endif %}
    </div>
  </div>

  <h4 class="to-header">NOTES</h4>
  <p>{{ to.notes }}</p>

  <h4 class="to-header">TRANSPORT DETAILS</h4>
  <table class="table table-sm table-to-details">
    <thead class="">
      <tr>
        <th></th>
        <th class="text-center">Units</th>
        <th class="text-right">Pallet Space</th>
        <th class="text-right">Footprint (m<sup>2</sup>)</th>
        <th>To</th>
      </tr>
      <tr>
        <th>Total</th>
        <th class="text-center">{{ totals.units|fi_nbr }}</th>
        <th class="text-right">{{ totals.pallet_space|fi_nbr }}</th>
        <th class="text-right">{{ totals.footprint|fi_nbr }}</th>
        <th></th>
      </tr>
    </thead>
    <tbody>
      {% for tol in to_lines %}
        <tr class="table-active">
          <td>{{ tol.equipment.name }}</td>
          <td class="text-center">{{ tol.equipment.unit_set.count }}</td>
          <td class="text-right">{{ tol.equipment.pallet_space|fi_nbr }}</td>
          <td class="text-right">{{ tol.equipment.footprint|fi_nbr }}</td>
          <td>
            {% if tol.transport_order.to_convention %}
              {{ tol.transport_order.to_convention.routing_name }}
            {% elif tol.transport_order.to_loc %}
              {{ tol.transport_order.to_loc.name }}
            {% endif %}
          </td>
        </tr>
        {% for unit in tol.equipment.get_parent_units %}
          <tr class="unit">
            <td>&#11036; {{ unit.name }}</td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
          </tr>
        {% endfor %}
      {% endfor %}
    </tbody>
  </table>

</div> <!-- .container -->

{% endblock %}

{% block javascript %}

<script>
$(document).ready(function() {
});
</script>

{% endblock %}
