{% extends "base.html" %}

{% block main %}

{% load i18n %}
{% load docs_extras %}
{% load qr_code %}

<div class="container to-container">
  <div class="text-center">
    <h1>TRANSPORT ORDER</h1>
    <h4>{{ to.name }}
      ({{ to.get_from_loc.abbreviation }} &mdash; {{ to.get_to_loc.abbreviation }})
    </h4>
  </div> <!-- .row -->

  <div class="row">
    <div class="col-6 align-middle">
      <div class="row">
        <div class="col-1">From:</div>
        <div class="col-11">
          {% if to.from_convention %}{{ to.from_convention.name }}{% elif to.from_loc %}{{ to.from_loc.name }}{% endif %}
        </div>
      </div>

      <div class="row">
        <div class="col-1">To:</div>
        <div class="col-11">
          {% if to.to_convention %}{{ to.to_convention.name }}{% elif to.to_loc %}{{ to.to_loc.name }}{% endif %}
        </div>
      </div>
    </div> <!-- .col -->

    <div class="col-6 text-right">
      {% qr_from_text dir_qr size="s" %}
    </div>
  </div> <!-- .row -->

  <h4 class="to-header">SHIPPING</h4>

  <div class="row">
    <div class="col-6">
      <div class="p-1 mb-2 bg-secondary text-white">
        <strong>LOADING</strong>
      </div>

      <strong>
      {% if to.from_convention.load_out %}
        {{ to.from_convention.load_out|date:"j.n.Y H:i" }}
      {% else %}
        {{ to.from_loc_load_out|date:"j.n.Y H:i" }}
      {% endif %}
      </strong>
      <br>

      {{ to.get_from_loc.address }}

      {% if to.get_from_loc.entrance %}
        <br>
        {{ to.get_from_loc.entrance }}
      {% endif %}
    </div>

    <div class="col-6">
      <div class="p-1 mb-2 bg-secondary text-white">
        <strong>UNLOADING</strong>
      </div>

      <strong>
      {% if to.to_convention.load_in %}
        {{ to.to_convention.load_in|date:"j.n.Y H:i" }}
      {% else %}
        {{ to.to_loc_load_in|date:"j.n.Y H:i" }}
      {% endif %}
      </strong>
      <br>

      {{ to.get_to_loc.address }}

      {% if to.get_to_loc.entrance %}
        <br>
        {{ to.get_to_loc.entrance }}
      {% endif %}
    </div>
  </div>
  <!-- 
  <div class="row">
    <div class="col-6">
      {% qr_from_text from_qr size="s" %}
    </div>
    <div class="col-6">
      {% qr_from_text to_qr size="s" %}
    </div>
  </div>
  -->

  <h4 class="to-header">CONTACT</h4>

  <div class="row">
    <div class="col-6">
      <div class="p-1 mb-2 bg-secondary text-white">
        <strong>SHIPPING CONTACT</strong>
      </div>

      {% if to.from_convention.contact_person %}
      {{ to.from_convention.contact_person|person }}<br>
      {% elif to.from_location.contact_person %}
      {{ to.from_location.contact_person|person }}<br>
      {% endif %}
    </div>

    <div class="col-6">
      <div class="p-1 mb-2 bg-secondary text-white">
        <strong>SHIPPING CONTACT</strong>
      </div>
      {% if to.to_convention.contact_person %}
      {{ to.to_convention.contact_person|person }}<br>
      {% elif to.to_location.contact_person %}
        {{ to.to_location.contact_person|person }}<br>
      {% endif %}
    </div>

  </div>

  <div class="row" style="margin-top: 1rem;">
    <div class="col-6">

      <div class="p-1 mb-2 bg-secondary text-white">
        <strong>TECHNICAL CONTACT</strong>
      </div>
      {% if to.from_convention.technical_contact %}
      {{ to.from_convention.technical_contact|person }}<br>
      {% elif to.from_location.technical_contact %}
      {{ to.from_location.technical_contact|person }}<br>
      {% endif %}
    </div>
    <div class="col-6">

      <div class="p-1 mb-2 bg-secondary text-white">
        <strong>TECHNICAL CONTACT</strong>
      </div>
      {% if to.to_convention.technical_contact %}
        {{ to.to_convention.technical_contact|person }}
      {% elif to.to_location.technical_contact %}
        {{ to.to_location.technical_contact|person }}
      {% endif %}

      <!--
      {% if to.to_convention.contact_person %}
        {{ to.to_convention.contact_person.name }}<br>
        {{ to.to_convention.contact_person.phone }}<br>
        {{ to.to_convention.contact_person.email }}
      {% endif %}
      -->
    </div>
  </div>

  <h4 class="to-header">NOTES</h4>
  <p>{{ to.notes }}</p>

  <h4 class="to-header">TRANSPORT DETAILS</h4>
  <table class="table table-sm table-to-details">
    <thead class="">
      <tr style="color: #fff !important; background-color: #95a5a6">
        <th style="width: 30%"></th>
        <th class="text-center" style="width: 10%">UNITS</th>
        <th class="text-right" style="width: 10%">PALLET SPACE</th>
        <th class="text-right" style="width: 10%">FOOTPRINT (m<sup>2</sup>)</th>
        <th class="text-right" style="width: 10%">WEIGHT (kg)</th>
        <th style="width: 30%; padding-left: 4rem;">TO</th>
      </tr>
      <tr>
        <th>TOTAL</th>
        <th class="text-center">{{ totals.units|fi_nbr }}</th>
        <th class="text-right">{{ totals.pallet_space|fi_nbr }}</th>
        <th class="text-right">{{ totals.footprint|fi_nbr }}</th>
        <th class="text-right">{{ totals.weight|fi_nbr }}</th>
        <th></th>
      </tr>
    </thead>
    <tbody>
      {% for tol in to_lines %}
        <tr class="table-active">
          <td>{{ tol.equipment.name }}</td>
          <td class="text-center">{{ tol.equipment.unit_set.count }}</td>
          <td class="text-right">{{ tol.equipment.pallet_space|fi_nbr }}</td>
          <td class="text-right">{{ tol.equipment.footprint|fi_nbr }}</td>
          <td class="text-right">{{ tol.equipment.weight_kg|fi_nbr }}</td>
          <td style="padding-left: 4rem;">
            {% if tol.transport_order.to_convention %}
              {{ tol.transport_order.to_convention.routing_name }}
            {% elif tol.transport_order.to_loc %}
              {{ tol.transport_order.to_loc.name }}
            {% endif %}
          </td>
        </tr>
        {% for unit in tol.equipment.get_parent_units %}
          <tr class="unit">
            <td>&#11036; {{ unit.name }}</td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
          </tr>
        {% endfor %}
      {% endfor %}
    </tbody>
  </table>

</div> <!-- .container -->

{% endblock %}

{% block javascript %}

<script>
$(document).ready(function() {
});
</script>

{% endblock %}
